<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>剧情包编辑器</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

    <link rel="stylesheet" type="text/css" href="mdl_selectfield.css">
    <script defer src="mdl_selectfield.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>

    <!-- Always shows a header, even in smaller screens. -->
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
        <header class="mdl-layout__header">
          <div class="mdl-layout__header-row">
            <!-- Title -->
            <span class="mdl-layout-title mdl-layout--large-screen-only">《Let's Break Up》剧情包编辑器</span>
            <!-- Add spacer, to align navigation to the right -->
            <div class="mdl-layout-spacer"></div>
            <!-- Navigation. We hide it in small screens. -->
            <nav class="mdl-navigation ">
              <a class="mdl-navigation__link" onclick="openSidePanel('json')">上传</a>
              <a class="mdl-navigation__link" onclick="openSidePanel('json')">导出</a>
              <a class="mdl-navigation__link" onclick="openSidePanel('run')">测试</a>
            </nav>
          </div>
        </header>

          <main class="mdl-layout__content">

              <!-- Side pannel -->
              <div id="sidepannel" class="sidepannel">
                  <a href="javascript:void(0)" class="closebtn" onclick="closeSidePanel()">&times;</a>

                  <!-- Editor pannel -->
                  <div class="sidepannel_content hidden"  id="pannel_editor">
                    <div class="sidepannel_title" id="editor_title">新建卡片</div>
                      <div class="mdl-grid">
                          <div class="mdl-cell mdl-cell--4-col">
                              <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eCardId">
                                <input class="mdl-textfield__input" type="text" id="cardId">
                                <label class="mdl-textfield__label" for="cardId">卡片ID</label>
                              </div>
                          </div>

                          <div class="mdl-cell mdl-cell--4-col" onmousedown="updateActionTitles()">
                              <div class="mdl-selectfield mdl-js-selectfield mdl-selectfield--floating-label" >
                                  <select class="mdl-selectfield__select" id="cardType" name="cardType" value="" >
                                    <option value="swipe">左右滑动</option>
                                    <option value="chat">微信聊天</option>
                                    <option value="moments">微信朋友圈</option>
                                    <option value="fail">游戏失败</option>
                                    <option value="success">游戏成功</option>
                                  </select>
                                  <label class="mdl-selectfield__label" for="cardType">卡片类型</label>
                                </div>
                          </div>

                          <div class="mdl-cell mdl-cell--3-col">
                              <div class="mdl-selectfield mdl-js-selectfield mdl-selectfield--floating-label">
                                  <select class="mdl-selectfield__select" id="timeLimit" name="timeLimit">
                                    <option value="0">否</option>
                                    <option value="1">是</option>
                                  </select>
                                  <label class="mdl-selectfield__label" for="timeLimit">是否限时</label>
                                </div>
                          </div>
                          
                      </div>
    
                      <div class="mdl-grid">
                          <div class="mdl-cell mdl-cell--10-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eInstructionText">
                                <textarea class="mdl-textfield__input" type="text" rows= "5" id="instructionText" ></textarea>
                                <label class="mdl-textfield__label" for="instructionText">故事剧情文本</label>
                            </div>
                          </div>
                      </div>

                      <div class="mdl-grid">
                          <div class="mdl-cell mdl-cell--10-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eCardText">
                                <textarea class="mdl-textfield__input" type="text" rows= "3" id="cardText" ></textarea>
                                <label class="mdl-textfield__label" for="cardText">卡片文本 (可空)</label>
                            </div>
                          </div>
                      </div>


                      <div class="mdl-grid">
                          <div class="mdl-cell mdl-cell--10-col">
                              <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eCardImage">
                                <input class="mdl-textfield__input" type="text" id="cardImage">
                                <label class="mdl-textfield__label" for="cardImage">卡片图片地址 (可空)</label>
                              </div>
                          </div>
                      </div>

                      <!-- action block template -->
                      <script type="text/html" id="action_template">
                        <div class="editor_actions">
                            <div class="actions_label" id="actionTitle#value#">#action#</div>
                            <div class="mdl-grid">
                                <div class="mdl-cell mdl-cell--10-col">
                                  <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eActionCardText#value#">
                                      <textarea class="mdl-textfield__input" type="text" rows= "3" id="actionCardText#value#" ></textarea>
                                      <label class="mdl-textfield__label" for="actionCardText#value#">选项说明文本</label>
                                  </div>
                                </div>
                            </div>

                            <div class="mdl-grid">
                                <div class="mdl-cell mdl-cell--10-col">
                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eNextCardId#value#">
                                      <input class="mdl-textfield__input" type="text" id="nextCardId#value#">
                                      <label class="mdl-textfield__label" for="nextCardId#value#">所关联卡片ID</label>
                                    </div>
                                </div>
                            </div>

                            <div class="mdl-grid">
                                <div class="mdl-cell mdl-cell--2-col">
                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eInterest#value#">
                                      <input class="mdl-textfield__input" type="text" id="interest#value#" pattern="-?[0-9]*(\.[0-9]+)?">
                                      <label class="mdl-textfield__label" for="interest#value#">好感</label>
                                    </div>
                                </div>
                                <div class="mdl-cell mdl-cell--2-col">
                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eLove#value#">
                                      <input class="mdl-textfield__input" type="text" id="love#value#" pattern="-?[0-9]*(\.[0-9]+)?">
                                      <label class="mdl-textfield__label" for="love#value#">情趣</label>
                                    </div>
                                </div>
                                <div class="mdl-cell mdl-cell--2-col">
                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eWealth#value#">
                                      <input class="mdl-textfield__input" type="text" id="wealth#value#" pattern="-?[0-9]*(\.[0-9]+)?">
                                      <label class="mdl-textfield__label" for="wealth#value#">财富</label>
                                    </div>
                                </div>
                                <div class="mdl-cell mdl-cell--2-col">
                                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eFamily#value#">
                                      <input class="mdl-textfield__input" type="text" id="family#value#" pattern="-?[0-9]*(\.[0-9]+)?">
                                      <label class="mdl-textfield__label" for="family#value#">亲友</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </script>

                    <div id="actions"></div>


                    <div class="mdl-grid">
                        <div class="mdl-cell mdl-cell--10-col">
                          <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eComment">
                              <textarea class="mdl-textfield__input" type="text" rows= "1" id="comment" ></textarea>
                              <label class="mdl-textfield__label" for="comment">备注 (可空)</label>
                          </div>
                          <div id="error" class="accent_color"><!--Saving Error info--></div>
                        </div>
                    </div>

                    <div class="mdl-grid" style="margin-bottom: 100px;">
                        <div class="mdl-cell mdl-cell--4-col">
                            <button onclick="saveEditorChanges()" style="width: 100%;" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                                保存
                            </button>
                        </div>
                        <div class="mdl-cell mdl-cell--4-col">
                            <button onclick="closeSidePanel()" style="width: 100%;" class="mdl-button mdl-js-button mdl-js-ripple-effect">
                                取消
                            </button>
                        </div>
                    </div>

                  </div>


                  <!-- Json pannel -->
                  <div class="sidepannel_content hidden" id="pannel_json">
                      <div class="sidepannel_title" id="editor_title">JSON导出与上传</div>

                      <div class="mdl-grid">
                          <div class="mdl-cell mdl-cell--12-col">
                            <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="eJsonEditor">
                                <textarea class="mdl-textfield__input" type="text" rows="10" id="jsonEditor" style="height: 300px;"></textarea>
                                <label class="mdl-textfield__label" for="jsonEditor">在此处输入JSON</label>
                            </div>

                            <br>
                            <p>导出编辑器内的JSON到文本框中</p>
                            <button onclick="exportJson()" style="width: 40%;" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                                生成JSON
                            </button>

                            <p style="padding-top:30px;">将文本框中的JSON导入到编辑器内</p>
                            <button onclick="importJson()" style="width: 40%;" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
                                导入JSON
                            </button>
                          </div>
                      </div>
                    
                  </div>


              </div>


            <div class="page-content">                
                  <div id="main">

                    <!-- card block template -->
                  <script type="text/html" id="card_template">
                    <div class="mdl-shadow--2dp center_div content" >
                        <div class="mdl-grid card_display" id="#cardId#">
                            <div class="mdl-cell mdl-cell--6-col" style="padding-right:20px;">
                                <div>
                                  <span class="mdl-chip"><span class="mdl-chip__text">卡片ID</span></span>
                                  <div id="dCardId" class="card_oneline_text accent_color">#cardId#</div>
                                </div>
                                <div>
                                    <span class="mdl-chip"><span class="mdl-chip__text">卡片类型</span></span>
                                    <div id="dCardType" class="card_oneline_text">#cardType#</div>
                                </div>
                                <div>
                                    <span class="mdl-chip"><span class="mdl-chip__text">是否限时</span></span>
                                    <div id="dTimeLimit" class="card_oneline_text">#timeLimit#</div>
                                </div>
                                <div>
                                    <span class="mdl-chip"><span class="mdl-chip__text">背景图片</span></span>
                                    <div id="dCardImage" class="card_oneline_text">#cardImage#</div>
                                </div>
                                <div class="card_action">
                                    <span class="mdl-chip"><span class="mdl-chip__text">故事剧情文本</span></span>
                                    <div id="dInstructionText" class="card_long_text">#instructionText#</div>
                                </div>
                                <div class="card_action">
                                    <span class="mdl-chip"><span class="mdl-chip__text">卡片文本</span></span>
                                    <div id="dCardText" class="card_long_text">#cardText#</div>
                                </div>
                                <div class="card_action">
                                    <span class="mdl-chip"><span class="mdl-chip__text">备注</span></span>
                                    <div id="dCardText" class="card_long_text">#comment#</div>
                                </div>

                            </div>
                            <div class="mdl-cell mdl-cell--6-col">
                                <div>
                                    <span class="mdl-chip"><span class="mdl-chip__text">#action1Title#</span></span>
                                    <div class="card_long_text">#action1Text#</div>
                                    <div class="accent_color">#action1effect#</div> 
                                </div>
                                <div class="card_action">
                                    <span class="mdl-chip"><span class="mdl-chip__text">#action2Title#</span></span>
                                    <div class="card_long_text">#action2Text#</div>
                                    <div class="accent_color">#action2effect#</div> 
                                </div>
                                <div class="card_action">
                                    <span class="mdl-chip"><span class="mdl-chip__text">#action3Title#</span></span>
                                    <div class="card_long_text">#action3Text#</div>
                                    <div class="accent_color">#action3effect#</div> 
                                </div>
                               
                            </div>
                          </div>

                      <div class="mdl-card__actions mdl-card--border" style="display:flex;">
                        <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" onclick="openEditorWithCardIndex(#index#)">
                          编辑
                        </a>
                        <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                            删除
                        </a>
                        <div class="mdl-layout-spacer"></div>
                        <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                            上移
                        </a>
                        <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                            下移
                        </a>
                      </div>
                    </div>
                </script>

                <div id="cards"></div>

                <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored fab" onclick="openEditorWithNew()">
                    <i class="material-icons">add</i>
                </button>



              </div>
            </div>
          </main>
        </div>
    
        <script src="script.js"></script>
</body>
</html>